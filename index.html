<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CarbonAudit | ISO Compliant Tracker</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Grotesk:wght@700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", sans-serif;
        overflow-x: hidden;
        margin: 0;
        padding: 0;
      }

      h1,
      h2,
      .brand-font {
        font-family: "Space Grotesk", sans-serif;
      }

      /* Utility Class to Hide Pages */
      .hidden-section {
        display: none !important;
      }

      /* Animations */
      .fade-in {
        animation: fadeIn 0.6s ease-out forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Cover Page Background */
      .hero-bg {
        background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
        position: relative;
      }

      /* Custom Dropdown Styling */
      .custom-select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.5rem center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
        appearance: none;
        -webkit-appearance: none;
      }
    </style>
  </head>

  <body class="bg-slate-50 text-slate-900">
    <div
      id="page-cover"
      class="w-full h-screen hero-bg flex flex-col items-center justify-center text-white p-6 relative overflow-hidden"
    >
      <div
        class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10"
      ></div>
      <div
        class="absolute top-1/4 left-1/4 w-96 h-96 bg-blue-600/20 rounded-full blur-[100px]"
      ></div>
      <div
        class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-emerald-600/20 rounded-full blur-[100px]"
      ></div>

      <div
        class="relative z-10 text-center max-w-4xl mx-auto space-y-8 animate-fade-in-up"
      >
        <div
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-blue-500/30 bg-blue-500/10 backdrop-blur-md text-blue-300 text-xs font-mono uppercase tracking-widest"
        >
          <span class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></span>
          System Online
        </div>

        <h1
          class="text-6xl md:text-8xl font-bold leading-tight tracking-tighter"
        >
          CarbonAudit<span class="text-blue-500">.io</span>
        </h1>

        <p
          class="text-xl md:text-2xl text-slate-300 font-light max-w-2xl mx-auto"
        >
          The industry standard for calculating heavy transport emissions.
          <br /><span class="text-slate-500"
            >Accurate. ISO-Compliant. Instant.</span
          >
        </p>

        <button
          onclick="goToApp()"
          class="group relative inline-flex items-center gap-3 px-8 py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-full font-bold text-lg transition-all transform hover:scale-105 shadow-lg shadow-blue-900/50"
        >
          Launch Calculator
          <i
            class="ph-bold ph-arrow-right group-hover:translate-x-1 transition-transform"
          ></i>
        </button>
      </div>

      <div class="absolute bottom-6 text-slate-500 text-xs font-mono">
        Hackathon Build v2.4 • Powered by EPA 2026 Data
      </div>
    </div>

    <div
      id="page-app"
      class="hidden-section min-h-screen bg-slate-50 flex flex-col fade-in"
    >
      <nav
        class="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center sticky top-0 z-50"
      >
        <div
          class="flex items-center gap-2 cursor-pointer"
          onclick="goToCover()"
        >
          <div
            class="bg-blue-600 text-white font-bold px-2 py-1 rounded text-lg"
          >
            ISO
          </div>
          <span
            class="text-xl font-bold tracking-tight text-slate-900 brand-font"
            >CarbonAudit</span
          >
        </div>
        <button
          onclick="goToCover()"
          class="text-sm font-semibold text-slate-500 hover:text-red-500 transition"
        >
          Exit Session
        </button>
      </nav>

      <main
        class="max-w-6xl mx-auto p-6 grid lg:grid-cols-2 gap-12 mt-8 w-full"
      >
        <section
          class="bg-white p-8 rounded-2xl shadow-xl border border-slate-100 h-fit"
        >
          <form id="calc-form">
            <div class="mb-8">
              <label
                class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest"
                >Vehicle Class</label
              >
              <div class="grid grid-cols-2 gap-4">
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="passenger"
                    class="peer sr-only"
                    checked
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-blue-600 peer-checked:bg-blue-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Passenger Car</div>
                    <div class="text-xs text-slate-500">Gasoline</div>
                  </div>
                </label>
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="heavy_duty"
                    class="peer sr-only"
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-blue-600 peer-checked:bg-blue-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Heavy Truck</div>
                    <div class="text-xs text-slate-500">Diesel</div>
                  </div>
                </label>
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="light_truck"
                    class="peer sr-only"
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-blue-600 peer-checked:bg-blue-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Light Van</div>
                    <div class="text-xs text-slate-500">Gasoline</div>
                  </div>
                </label>
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="electric"
                    class="peer sr-only"
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-green-600 peer-checked:bg-green-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Electric (EV)</div>
                    <div class="text-xs text-slate-500">Grid Mix</div>
                  </div>
                </label>
              </div>
            </div>

            <div class="mb-8">
              <label
                class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest"
                >Distance Traveled</label
              >
              <div class="flex items-center relative">
                <input
                  type="number"
                  id="distance"
                  placeholder="0"
                  class="w-full p-4 pr-32 text-xl font-bold border-2 border-slate-200 rounded-xl focus:border-blue-600 focus:outline-none text-slate-900"
                />
                <div class="absolute right-2 top-2 bottom-2">
                  <select
                    id="unit-select"
                    class="custom-select h-full bg-slate-100 text-slate-700 font-bold px-4 rounded-lg outline-none cursor-pointer hover:bg-slate-200"
                  >
                    <option value="km" selected>KM</option>
                    <option value="mi">Miles</option>
                  </select>
                </div>
              </div>
            </div>
          </form>
        </section>

        <section class="flex flex-col gap-6">
          <div
            class="bg-slate-900 text-white p-8 rounded-3xl shadow-2xl relative overflow-hidden"
          >
            <div
              class="absolute top-0 right-0 w-64 h-64 bg-blue-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse"
            ></div>

            <div class="relative z-10">
              <p
                class="text-blue-400 font-bold uppercase text-xs mb-2 tracking-widest"
              >
                Carbon Footprint
              </p>
              <h2 class="text-7xl font-black tracking-tighter mb-2">
                <span id="result">0.0</span>
                <span class="text-2xl text-slate-500 font-medium">kg</span>
              </h2>

              <div
                class="mt-8 border-t border-white/10 pt-6 flex justify-between"
              >
                <div>
                  <p class="text-xs text-slate-400 uppercase mb-1">
                    Applied Factor
                  </p>
                  <p
                    class="font-mono text-emerald-400 font-bold"
                    id="factor-display"
                  >
                    0.000 kg/km
                  </p>
                </div>
                <div class="text-right">
                  <p class="text-xs text-slate-400 uppercase mb-1">Unit</p>
                  <p class="font-mono text-white font-bold" id="method-unit">
                    km
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div
            class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 flex-grow min-h-[250px] relative"
          >
            <canvas id="auditChart"></canvas>
          </div>
        </section>
      </main>
    </div>

    <script>
      // --- PAGE SWITCHING LOGIC ---
      function goToApp() {
        document.getElementById("page-cover").classList.add("hidden-section");
        document.getElementById("page-app").classList.remove("hidden-section");
        window.scrollTo(0, 0);
        // Re-render chart to prevent rendering glitches
        if (window.myChart) {
          window.myChart.resize();
        }
      }

      function goToCover() {
        document.getElementById("page-app").classList.add("hidden-section");
        document
          .getElementById("page-cover")
          .classList.remove("hidden-section");
        window.scrollTo(0, 0);
      }

      // --- CALCULATOR LOGIC ---
      document.addEventListener("DOMContentLoaded", function () {
        const FACTORS_MILE = {
          passenger: { val: 0.355, color: "#3b82f6" },
          light_truck: { val: 0.46, color: "#f59e0b" },
          heavy_duty: { val: 1.631, color: "#ef4444" },
          electric: { val: 0.11, color: "#10b981" },
        };
        const KM_CONVERSION = 1.60934;

        const form = document.getElementById("calc-form");
        const distInput = document.getElementById("distance");
        const unitSelect = document.getElementById("unit-select");
        const resultEl = document.getElementById("result");
        const factorEl = document.getElementById("factor-display");
        const unitLabelEl = document.getElementById("method-unit");

        // Chart Init
        const ctx = document.getElementById("auditChart").getContext("2d");
        window.myChart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: ["Your Fleet", "Sustainable Target"],
            datasets: [
              {
                label: "Emissions (kg)",
                data: [0, 100],
                backgroundColor: ["#3b82f6", "#e2e8f0"],
                borderRadius: 8,
                barThickness: 50,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              y: {
                beginAtZero: true,
                grid: { display: true, color: "#f1f5f9" },
              },
              x: { grid: { display: false } },
            },
          },
        });

        function calculate() {
          const radio = document.querySelector('input[name="vehicle"]:checked');
          if (!radio) return;

          const vehicleType = radio.value;
          const distVal = parseFloat(distInput.value);
          const distance = isNaN(distVal) ? 0 : distVal;
          const unit = unitSelect.value;

          const baseData = FACTORS_MILE[vehicleType];
          let finalFactor = 0;
          let unitText = "";

          if (unit === "mi") {
            finalFactor = baseData.val;
            unitText = "kg/mi";
          } else {
            finalFactor = baseData.val / KM_CONVERSION;
            unitText = "kg/km";
          }

          const total = distance * finalFactor;

          // Update UI
          resultEl.innerText = total.toLocaleString(undefined, {
            minimumFractionDigits: 1,
            maximumFractionDigits: 1,
          });
          factorEl.innerText = `${finalFactor.toFixed(3)} ${unitText}`;
          unitLabelEl.innerText = unit;

          // Update Chart
          window.myChart.data.datasets[0].data[0] = total;
          window.myChart.data.datasets[0].backgroundColor[0] = baseData.color;

          // Dynamic Target (e.g. 100kg benchmark)
          window.myChart.data.datasets[0].data[1] = 100;

          window.myChart.update();
        }

        // Listeners
        form.addEventListener("change", calculate);
        distInput.addEventListener("input", calculate);
        unitSelect.addEventListener("change", calculate);

        // Initial Run
        calculate();
      });
    </script>
  </body>
</html>
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CarbonAudit | ISO Compliant Tracker</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Grotesk:wght@700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", sans-serif;
        overflow-x: hidden;
        margin: 0;
        padding: 0;
      }

      h1,
      h2,
      .brand-font {
        font-family: "Space Grotesk", sans-serif;
      }

      /* Utility Class to Hide Pages */
      .hidden-section {
        display: none !important;
      }

      /* Animations */
      .fade-in {
        animation: fadeIn 0.6s ease-out forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Cover Page Background */
      .hero-bg {
        background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
        position: relative;
      }

      /* Custom Dropdown Styling */
      .custom-select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.5rem center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
        appearance: none;
        -webkit-appearance: none;
      }
    </style>
  </head>

  <body class="bg-slate-50 text-slate-900">
    <div
      id="page-cover"
      class="w-full h-screen hero-bg flex flex-col items-center justify-center text-white p-6 relative overflow-hidden"
    >
      <div
        class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10"
      ></div>
      <div
        class="absolute top-1/4 left-1/4 w-96 h-96 bg-blue-600/20 rounded-full blur-[100px]"
      ></div>
      <div
        class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-emerald-600/20 rounded-full blur-[100px]"
      ></div>

      <div
        class="relative z-10 text-center max-w-4xl mx-auto space-y-8 animate-fade-in-up"
      >
        <div
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-blue-500/30 bg-blue-500/10 backdrop-blur-md text-blue-300 text-xs font-mono uppercase tracking-widest"
        >
          <span class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></span>
          System Online
        </div>

        <h1
          class="text-6xl md:text-8xl font-bold leading-tight tracking-tighter"
        >
          CarbonAudit<span class="text-blue-500">.io</span>
        </h1>

        <p
          class="text-xl md:text-2xl text-slate-300 font-light max-w-2xl mx-auto"
        >
          The industry standard for calculating heavy transport emissions.
          <br /><span class="text-slate-500"
            >Accurate. ISO-Compliant. Instant.</span
          >
        </p>

        <button
          onclick="goToApp()"
          class="group relative inline-flex items-center gap-3 px-8 py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-full font-bold text-lg transition-all transform hover:scale-105 shadow-lg shadow-blue-900/50"
        >
          Launch Calculator
          <i
            class="ph-bold ph-arrow-right group-hover:translate-x-1 transition-transform"
          ></i>
        </button>
      </div>

      <div class="absolute bottom-6 text-slate-500 text-xs font-mono">
        Hackathon Build v2.4 • Powered by EPA 2026 Data
      </div>
    </div>

    <div
      id="page-app"
      class="hidden-section min-h-screen bg-slate-50 flex flex-col fade-in"
    >
      <nav
        class="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center sticky top-0 z-50"
      >
        <div
          class="flex items-center gap-2 cursor-pointer"
          onclick="goToCover()"
        >
          <div
            class="bg-blue-600 text-white font-bold px-2 py-1 rounded text-lg"
          >
            ISO
          </div>
          <span
            class="text-xl font-bold tracking-tight text-slate-900 brand-font"
            >CarbonAudit</span
          >
        </div>
        <button
          onclick="goToCover()"
          class="text-sm font-semibold text-slate-500 hover:text-red-500 transition"
        >
          Exit Session
        </button>
      </nav>

      <main
        class="max-w-6xl mx-auto p-6 grid lg:grid-cols-2 gap-12 mt-8 w-full"
      >
        <section
          class="bg-white p-8 rounded-2xl shadow-xl border border-slate-100 h-fit"
        >
          <form id="calc-form">
            <div class="mb-8">
              <label
                class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest"
                >Vehicle Class</label
              >
              <div class="grid grid-cols-2 gap-4">
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="passenger"
                    class="peer sr-only"
                    checked
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-blue-600 peer-checked:bg-blue-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Passenger Car</div>
                    <div class="text-xs text-slate-500">Gasoline</div>
                  </div>
                </label>
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="heavy_duty"
                    class="peer sr-only"
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-blue-600 peer-checked:bg-blue-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Heavy Truck</div>
                    <div class="text-xs text-slate-500">Diesel</div>
                  </div>
                </label>
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="light_truck"
                    class="peer sr-only"
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-blue-600 peer-checked:bg-blue-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Light Van</div>
                    <div class="text-xs text-slate-500">Gasoline</div>
                  </div>
                </label>
                <label class="cursor-pointer group">
                  <input
                    type="radio"
                    name="vehicle"
                    value="electric"
                    class="peer sr-only"
                  />
                  <div
                    class="p-4 rounded-xl border-2 border-slate-100 peer-checked:border-green-600 peer-checked:bg-green-50 hover:bg-slate-50 transition"
                  >
                    <div class="font-bold text-slate-900">Electric (EV)</div>
                    <div class="text-xs text-slate-500">Grid Mix</div>
                  </div>
                </label>
              </div>
            </div>

            <div class="mb-8">
              <label
                class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest"
                >Distance Traveled</label
              >
              <div class="flex items-center relative">
                <input
                  type="number"
                  id="distance"
                  placeholder="0"
                  class="w-full p-4 pr-32 text-xl font-bold border-2 border-slate-200 rounded-xl focus:border-blue-600 focus:outline-none text-slate-900"
                />
                <div class="absolute right-2 top-2 bottom-2">
                  <select
                    id="unit-select"
                    class="custom-select h-full bg-slate-100 text-slate-700 font-bold px-4 rounded-lg outline-none cursor-pointer hover:bg-slate-200"
                  >
                    <option value="km" selected>KM</option>
                    <option value="mi">Miles</option>
                  </select>
                </div>
              </div>
            </div>
          </form>
        </section>

        <section class="flex flex-col gap-6">
          <div
            class="bg-slate-900 text-white p-8 rounded-3xl shadow-2xl relative overflow-hidden"
          >
            <div
              class="absolute top-0 right-0 w-64 h-64 bg-blue-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse"
            ></div>

            <div class="relative z-10">
              <p
                class="text-blue-400 font-bold uppercase text-xs mb-2 tracking-widest"
              >
                Carbon Footprint
              </p>
              <h2 class="text-7xl font-black tracking-tighter mb-2">
                <span id="result">0.0</span>
                <span class="text-2xl text-slate-500 font-medium">kg</span>
              </h2>

              <div
                class="mt-8 border-t border-white/10 pt-6 flex justify-between"
              >
                <div>
                  <p class="text-xs text-slate-400 uppercase mb-1">
                    Applied Factor
                  </p>
                  <p
                    class="font-mono text-emerald-400 font-bold"
                    id="factor-display"
                  >
                    0.000 kg/km
                  </p>
                </div>
                <div class="text-right">
                  <p class="text-xs text-slate-400 uppercase mb-1">Unit</p>
                  <p class="font-mono text-white font-bold" id="method-unit">
                    km
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div
            class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 flex-grow min-h-[250px] relative"
          >
            <canvas id="auditChart"></canvas>
          </div>
        </section>
      </main>
    </div>

    <script>
      // --- PAGE SWITCHING LOGIC ---
      function goToApp() {
        document.getElementById("page-cover").classList.add("hidden-section");
        document.getElementById("page-app").classList.remove("hidden-section");
        window.scrollTo(0, 0);
        // Re-render chart to prevent rendering glitches
        if (window.myChart) {
          window.myChart.resize();
        }
      }

      function goToCover() {
        document.getElementById("page-app").classList.add("hidden-section");
        document
          .getElementById("page-cover")
          .classList.remove("hidden-section");
        window.scrollTo(0, 0);
      }

      // --- CALCULATOR LOGIC ---
      document.addEventListener("DOMContentLoaded", function () {
        const FACTORS_MILE = {
          passenger: { val: 0.355, color: "#3b82f6" },
          light_truck: { val: 0.46, color: "#f59e0b" },
          heavy_duty: { val: 1.631, color: "#ef4444" },
          electric: { val: 0.11, color: "#10b981" },
        };
        const KM_CONVERSION = 1.60934;

        const form = document.getElementById("calc-form");
        const distInput = document.getElementById("distance");
        const unitSelect = document.getElementById("unit-select");
        const resultEl = document.getElementById("result");
        const factorEl = document.getElementById("factor-display");
        const unitLabelEl = document.getElementById("method-unit");

        // Chart Init
        const ctx = document.getElementById("auditChart").getContext("2d");
        window.myChart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: ["Your Fleet", "Sustainable Target"],
            datasets: [
              {
                label: "Emissions (kg)",
                data: [0, 100],
                backgroundColor: ["#3b82f6", "#e2e8f0"],
                borderRadius: 8,
                barThickness: 50,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              y: {
                beginAtZero: true,
                grid: { display: true, color: "#f1f5f9" },
              },
              x: { grid: { display: false } },
            },
          },
        });

        function calculate() {
          const radio = document.querySelector('input[name="vehicle"]:checked');
          if (!radio) return;

          const vehicleType = radio.value;
          const distVal = parseFloat(distInput.value);
          const distance = isNaN(distVal) ? 0 : distVal;
          const unit = unitSelect.value;

          const baseData = FACTORS_MILE[vehicleType];
          let finalFactor = 0;
          let unitText = "";

          if (unit === "mi") {
            finalFactor = baseData.val;
            unitText = "kg/mi";
          } else {
            finalFactor = baseData.val / KM_CONVERSION;
            unitText = "kg/km";
          }

          const total = distance * finalFactor;

          // Update UI
          resultEl.innerText = total.toLocaleString(undefined, {
            minimumFractionDigits: 1,
            maximumFractionDigits: 1,
          });
          factorEl.innerText = `${finalFactor.toFixed(3)} ${unitText}`;
          unitLabelEl.innerText = unit;

          // Update Chart
          window.myChart.data.datasets[0].data[0] = total;
          window.myChart.data.datasets[0].backgroundColor[0] = baseData.color;

          // Dynamic Target (e.g. 100kg benchmark)
          window.myChart.data.datasets[0].data[1] = 100;

          window.myChart.update();
        }

        // Listeners
        form.addEventListener("change", calculate);
        distInput.addEventListener("input", calculate);
        unitSelect.addEventListener("change", calculate);

        // Initial Run
        calculate();
      });
    </script>
  </body>
</html>
